(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{495:function(e,s,a){"use strict";a.r(s);var t=a(30),r=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"nexus搭建maven私服"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nexus搭建maven私服"}},[e._v("#")]),e._v(" Nexus搭建Maven私服")]),e._v(" "),a("h2",{attrs:{id:"_1-什么是-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是-nexus"}},[e._v("#")]),e._v(" 1. 什么是 Nexus")]),e._v(" "),a("h3",{attrs:{id:"_1-1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-概述"}},[e._v("#")]),e._v(" 1.1 概述")]),e._v(" "),a("p",[e._v("Nexus 是一个强大的仓库管理器，极大地简化了内部仓库的维护和外部仓库的访问。")]),e._v(" "),a("p",[e._v("2016 年 4 月 6 日 Nexus 3.0 版本发布，相较 2.x 版本有了很大的改变：")]),e._v(" "),a("ul",[a("li",[e._v("对低层代码进行了大规模重构，提升性能，增加可扩展性以及改善用户体验。")]),e._v(" "),a("li",[e._v("升级界面，极大的简化了用户界面的操作和管理。")]),e._v(" "),a("li",[e._v("提供新的安装包，让部署更加简单。")]),e._v(" "),a("li",[e._v("增加对 Docker, NeGet, npm, Bower 的支持。")]),e._v(" "),a("li",[e._v("提供新的管理接口，以及增强对自动任务的管理。")])]),e._v(" "),a("h2",{attrs:{id:"_2-安装-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装-nexus"}},[e._v("#")]),e._v(" 2. 安装 Nexus")]),e._v(" "),a("h3",{attrs:{id:"_2-1-基于-docker-安装-nexus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-基于-docker-安装-nexus"}},[e._v("#")]),e._v(" 2.1 基于 Docker 安装 Nexus")]),e._v(" "),a("p",[e._v("我们使用 Docker 来安装和运行 Nexus，docker-compose.yml 配置如下：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("version: '3.1'\nservices:\n  nexus:\n    restart: always\n    image: sonatype/nexus3\n    container_name: nexus\n    ports:\n      - 8081:8081\n    volumes:\n      - /usr/local/docker/nexus/data:/nexus-data\n")])])]),a("p",[e._v("注： 启动时如果出现权限问题可以使用：chmod 777 /usr/local/docker/nexus/data 赋予数据卷目录可读可写的权限")]),e._v(" "),a("h2",{attrs:{id:"_2-2-登录控制台验证安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-登录控制台验证安装"}},[e._v("#")]),e._v(" 2.2 登录控制台验证安装")]),e._v(" "),a("p",[e._v("地址：http://ip:port/ 用户名：admin 密码：admin123")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/wuyilong/picture-bed/raw/master/img/Nexus.png",alt:"Nexus"}})]),e._v(" "),a("h2",{attrs:{id:"_3-maven-仓库介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-maven-仓库介绍"}},[e._v("#")]),e._v(" 3. Maven 仓库介绍")]),e._v(" "),a("h3",{attrs:{id:"_3-1-代理仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-代理仓库"}},[e._v("#")]),e._v(" 3.1 代理仓库")]),e._v(" "),a("p",[e._v("意为第三方仓库，如：")]),e._v(" "),a("ul",[a("li",[e._v("maven-central")]),e._v(" "),a("li",[e._v("nuget.org-proxy")])]),e._v(" "),a("p",[e._v("版本策略（Version Policy）：")]),e._v(" "),a("ul",[a("li",[e._v("Release: 正式版本")]),e._v(" "),a("li",[e._v("Snapshot: 快照版本")]),e._v(" "),a("li",[e._v("Mixed: 混合模式")])]),e._v(" "),a("p",[e._v("布局策略（Layout Policy）：")]),e._v(" "),a("ul",[a("li",[e._v("Strict：严格")]),e._v(" "),a("li",[e._v("Permissive：宽松")])]),e._v(" "),a("h3",{attrs:{id:"_3-2-宿主仓库-hosted-repository"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-宿主仓库-hosted-repository"}},[e._v("#")]),e._v(" 3.2 宿主仓库（Hosted Repository）")]),e._v(" "),a("p",[e._v("存储本地上传的组件和资源的，如：")]),e._v(" "),a("ul",[a("li",[e._v("maven-releases")]),e._v(" "),a("li",[e._v("maven-snapshots")]),e._v(" "),a("li",[e._v("nuget-hosted")])]),e._v(" "),a("p",[e._v("部署策略（Deployment Policy）：")]),e._v(" "),a("ul",[a("li",[e._v("Allow Redeploy：允许重新部署")]),e._v(" "),a("li",[e._v("Disable Redeploy：禁止重新部署")]),e._v(" "),a("li",[e._v("Read-Only：只读")])]),e._v(" "),a("h3",{attrs:{id:"_3-3-仓库组-repository-group"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-仓库组-repository-group"}},[e._v("#")]),e._v(" 3.3 仓库组（Repository Group）")]),e._v(" "),a("p",[e._v("通常包含了多个代理仓库和宿主仓库，在项目中只要引入仓库组就可以下载到代理仓库和宿主仓库中的包，如：")]),e._v(" "),a("ul",[a("li",[e._v("maven-public")]),e._v(" "),a("li",[e._v("nuget-group")])]),e._v(" "),a("h2",{attrs:{id:"_4-在项目中使用-maven-私服"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-在项目中使用-maven-私服"}},[e._v("#")]),e._v(" 4. 在项目中使用 Maven 私服")]),e._v(" "),a("h3",{attrs:{id:"_4-1-配置认证信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-配置认证信息"}},[e._v("#")]),e._v(" 4.1 配置认证信息")]),e._v(" "),a("p",[e._v("在 Maven settings.xml 中添加 Nexus 认证信息(servers 节点下)：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<server>\n  <id>nexus-releases</id>\n  <username>admin</username>\n  <password>admin123</password>\n</server>\n\n<server>\n  <id>nexus-snapshots</id>\n  <username>admin</username>\n  <password>admin123</password>\n</server>\n")])])]),a("h3",{attrs:{id:"_4-2-snapshots-与-releases-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-snapshots-与-releases-的区别"}},[e._v("#")]),e._v(" 4.2 Snapshots 与 Releases 的区别")]),e._v(" "),a("ul",[a("li",[e._v("nexus-releases: 用于发布 Release 版本")]),e._v(" "),a("li",[e._v("nexus-snapshots: 用于发布 Snapshot 版本（快照版）")]),e._v(" "),a("li",[e._v("在项目 pom.xml 中设置的版本号添加 SNAPSHOT 标识的都会发布为 SNAPSHOT 版本，没有 SNAPSHOT 标识的都会发布为 RELEASE 版本。")]),e._v(" "),a("li",[e._v("SNAPSHOT 版本会自动加一个时间作为标识，如：1.0.0-SNAPSHOT 发布后为变成 1.0.0-SNAPSHOT-20180522.123456-1.jar")]),e._v(" "),a("li",[e._v("使用场景:\n"),a("ul",[a("li",[e._v("snapshot：\n依赖库中的jar包正被开发中，\n依赖库中的jar包若处于不断更新，更准确的说是不停deploy时，包会被不断发布到私服，但版本号不需要修改，私服中会自动追加后缀时间为版本名，我们使用时，会自动load时间最近也即最新的版本，\n例子：格式："),a("version",[e._v("1.0-snapshot")])],1),e._v(" "),a("li",[e._v("release：\n依赖库中的jar包功能确定时，\n其他系统使用时，版本号不变，依赖包则不变，不会自动load最新版本，\n例子："),a("version",[e._v("1.0")]),e._v("，去掉-snapshot即可")],1)])])]),e._v(" "),a("h3",{attrs:{id:"_4-3-配置自动化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-配置自动化部署"}},[e._v("#")]),e._v(" 4.3 配置自动化部署")]),e._v(" "),a("p",[e._v("在 pom.xml 中添加如下代码：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<distributionManagement>  \n  <repository>  \n    <id>nexus-releases</id>  \n    <name>Nexus Release Repository</name>  \n    <url>http://127.0.0.1:8081/repository/maven-releases/</url>  \n  </repository>  \n  <snapshotRepository>  \n    <id>nexus-snapshots</id>  \n    <name>Nexus Snapshot Repository</name>  \n    <url>http://127.0.0.1:8081/repository/maven-snapshots/</url>  \n  </snapshotRepository>     \n</distributionManagement>\n")])])]),a("p",[e._v("注意事项：")]),e._v(" "),a("ul",[a("li",[e._v("ID 名称必须要与 settings.xml 中 Servers 配置的 ID 名称保持一致。")]),e._v(" "),a("li",[e._v("项目版本号中有 SNAPSHOT 标识的，会发布到 Nexus Snapshots Repository, 否则发布到 Nexus Release Repository，并根据 ID 去匹配授权账号。")])]),e._v(" "),a("h3",{attrs:{id:"_4-4-部署到仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-部署到仓库"}},[e._v("#")]),e._v(" 4.4 部署到仓库")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mvn deploy\n")])])]),a("h3",{attrs:{id:"_4-5-上传第三方-jar-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-上传第三方-jar-包"}},[e._v("#")]),e._v(" 4.5 上传第三方 JAR 包")]),e._v(" "),a("p",[e._v("Nexus 3.0 不支持页面上传，可使用 maven 命令：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# 如第三方JAR包：aliyun-sdk-oss-2.2.3.jar\nmvn deploy:deploy-file \n  -DgroupId=com.aliyun.oss \n  -DartifactId=aliyun-sdk-oss \n  -Dversion=2.2.3 \n  -Dpackaging=jar \n  -Dfile=D:\\aliyun-sdk-oss-2.2.3.jar \n  -Durl=http://127.0.0.1:8081/repository/maven-3rd/ \n  -DrepositoryId=nexus-releases\n")])])]),a("p",[e._v("注意事项：")]),e._v(" "),a("ul",[a("li",[e._v("建议在上传第三方 JAR 包时，创建单独的第三方 JAR 包管理仓库，便于管理有维护。（maven-3rd）")]),e._v(" "),a("li",[e._v("-DrepositoryId=nexus-releases 对应的是 settings.xml 中 Servers 配置的 ID 名称。（授权）")])]),e._v(" "),a("h3",{attrs:{id:"_4-6-配置代理仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-配置代理仓库"}},[e._v("#")]),e._v(" 4.6 配置代理仓库")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<repositories>\n    <repository>\n        <id>nexus</id>\n        <name>Nexus Repository</name>\n        <url>http://127.0.0.1:8081/repository/maven-public/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n        <releases>\n            <enabled>true</enabled>\n        </releases>\n    </repository>\n</repositories>\n<pluginRepositories>\n    <pluginRepository>\n        <id>nexus</id>\n        <name>Nexus Plugin Repository</name>\n        <url>http://127.0.0.1:8081/repository/maven-public/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n        <releases>\n            <enabled>true</enabled>\n        </releases>\n    </pluginRepository>\n</pluginRepositories>\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);